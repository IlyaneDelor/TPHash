





<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  
  <script type="text/javascript" src="http://yandex.st/jquery/1.4.2/jquery.min.js"></script>
  <script type="text/javascript" src="../js/jsencrypt.js"></script> 
  <script type="text/javascript" src="../js/jsencrypt.min.js"></script> 
  


  <title>TPHash</title>
</head>

<body>

  <header style ="padding-bottom: 2%;">
   

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#">Home</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="MD5.html">MD5</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="SHA-256.html">SHA-256</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="SHA3-512.html">SHA3-512</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="Keccak-512.html">Keccak-512</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="RipeMD160.html">RipeMD160</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="AES.html">AES</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="RSA.html">RSA</a>
          </li>
          <li class="nav-item">
            <a class="nav-link disabled" href="BlowFish.html">BlowFish
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </header>


  
  <h1 class="text-center text-uppercase m-4">RSA : Script Hashage <small class="text-muted"> TP</small></h1>
  <body onload="init()">
   <div class="form-group row">
     <input style="margin:auto; margin-top: 2%; margin-bottom: 2%; " class="btn btn-primary"  id="fileInput" type="file" name="file" value="Upload" >
   </div>
   <h4 class="text-center text-uppercase m-4"><small class="text-muted">Reload Pour Upload un file et cliquez sur d√©chiffrement ou Chiffrement </small></h1>
   </body>
   <body>
     <form>

       


      <div class="form-group row">
       <label for="colFormLabel" class="col-sm-2 col-form-label">  Public Key</label>
       <div class="col-sm-10">
        <textarea name="text"placeholder="PUBLIC KEY" id = "pubkey" class="form-control" rows="12" cols="70"></textarea><br/>
      </div>
    </div>

    <div class="form-group row">
      <label for="colFormLabel" class="col-sm-2 col-form-label"> Private Key</label>
      <div class="col-sm-10">
        <textarea type="text" id="privkey" placeholder="Private KEY"size="56" class="form-control" ></textarea><br/>
      </div>
    </div> 
    <div class="form-group row">
      <label for="colFormLabel" class="col-sm-2 col-form-label">  Text to Encrypt</label>
      <div class="col-sm-10">
        <textarea type="text" id="input" placeholder="Text to Encrypt "size="56" class="form-control"></textarea><br/>
      </div>
    </div>

    <div class="form-group row">
      <input style="margin:auto; margin-top: 2%; margin-bottom: 2%; " class="btn btn-primary"  id="encrypt" type="button" name="encrypt" value="Chiffrement  RSA">
      
      <textarea name="result" id="encrypted" class="form-control" rows="12" cols="70"></textarea>
    </div>
    <div class="form-group row">
      <input type="button" onclick="strDownload(encrypted.value, 'result.txt');" style="margin:auto; margin-top: 2%; margin-bottom: 2%;" 
      class="btn btn-primary" value="DOWNLOAD RESULT">
    </div>
    <div class="form-group row">
      <input style="margin:auto; margin-top: 2%; margin-bottom: 2%; " class="btn btn-primary"  id="decrypt" type="button" name="encrypt" value="Dechiffrement  RSA">
      
      <textarea name="result" id="decrypted" class="form-control" rows="12" cols="70"></textarea>
    </div>
    <div class="form-group row">
     <input type="button" onclick="strDownload(decrypted.value, 'result.txt');" style="margin:auto; margin-top: 2%; margin-bottom: 2%;" 
     class="btn btn-primary" value="DOWNLOAD RESULT">
   </div>

 </form>
 <script type="text/javascript">
  document.querySelector("#encrypt").addEventListener("click", function() {

    var str = input.value;
    var parts = str.match(/[\s\S]{1,50}/g) || [];
    console.log(parts.length);
    console.log(parts);
    var result = "";
    const encrypt = new JSEncrypt();

    
    encrypt.setPublicKey(document.querySelector("#pubkey").value);

    console.log(''.match(/[\s\S]{1,3}/g) || []);

    for (var i = 0; i < parts.length ; i++) {
      var test = parts[i];
      
      var result = result + encrypt.encrypt(test);




    };
    document.querySelector("#encrypted").value = result;


  });


  document.querySelector("#decrypt").addEventListener("click", function() {
    const decrypt = new JSEncrypt();
    
    decrypt.setPrivateKey(document.querySelector("#privkey").value);
    var yes = encrypted.value;
    if (encrypted.value == "") {
      var yes = input.value;

    }
    var str2 = yes.split("=");
    var text =""
    console.log(str2);
    for (var i = 0; i < str2.length -1; i++) {
      var test2 = str2[i];

      text = text + decrypt.decrypt(test2);

    };
    document.querySelector("#decrypted").value = text;

  });











  function init(){
    document.getElementById('fileInput').addEventListener('change', handleFileSelect, false);
  }

  function handleFileSelect(event){
    const reader = new FileReader()
    reader.onload = handleFileLoad;
    reader.readAsText(event.target.files[0])
  }

  function handleFileLoad(event){
    console.log(event);
    document.getElementById('input').textContent = event.target.result;
  }




  function strDownload(a, b) {
    a = '' + a;
    b = b || 'strDownload.txt';
    var c = document.createElement('A'),
    d = document.body;
    d.appendChild(c);
    c.href = 'data:text/plain;charset=utf-8,' + encodeURIComponent(a);
    c.download = b;
    c.click();
    d.removeChild(c);
  }

</script>



</body>
</html>