    <!doctype html>
    <html lang="en">
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
      <script src="../main.js"></script>
      <script type="text/javascript" src="crypto-js/crypto-js.js"></script>
       <script language="JavaScript" src="../js/md5.js"></script>
      <link rel="stylesheet" href="../style.css" />
      <title>TPHash</title>
    </head>

    <body>

      <header>

        <nav class="navbar navbar-expand-lg navbar-light bg-light">
          <a class="navbar-brand" href="index.html">Home</a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="MD5.html">MD5</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="SHA-256.html">SHA-256</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="SHA3-512.html">SHA3-512</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="Keccak-512.html">Keccak-512</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="RipeMD160.html">RipeMD160</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="AES.html">AES</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="RSA.html">RSA</a>
              </li>
              <li class="nav-item">
                <a class="nav-link disabled" href="BlowFish.html">BlowFish
                </a>
              </li>
            </ul>
          </div>
        </nav>
      </header>


      
      <h1 class="text-center text-uppercase m-4">REGISTER <small class="text-muted"> TP</small></h1>
      <div class="aligncenter">
        <form class="form">
          <input type="hidden" id="field-id" value="" />

          <div class="form-group row">
            <label for="field-name" class="col-sm-2 col-form-label">Name</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="field-name" placeholder="Name" >
            </div>
          </div>


          <div class="form-group row">
            <label for="field-pass" class="col-sm-2 col-form-label"> PassWord</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="field-pass" placeholder="PassWord" >
            </div>
          </div>

          <div class="form-group row">
            <label for="field-mail" class="col-sm-2 col-form-label"> E-mail</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="field-mail" placeholder="E-mail" >
            </div>
          </div>




          <div class="form-group row">
            <input type="button" style="margin:auto; margin-top: 2%; margin-bottom: 2%;
            " id="btn-save"  class="btn btn-primary" value="Save">
          </div>
           <h4 class="text-center text-uppercase m-4"><small class="text-muted"> Click on your name in the Array Bellow and click on delete </small></h4>
          <div class="form-group row">
            <input type="button" style="margin:auto; margin-top: 2%; margin-bottom: 2%;
            " id="btn-delet"  class="btn btn-primary" value="DELETE">
          </div>
               <div class="col-sm-10">
        <textarea type="text" class="form-control" name ="resultReg" id="resultReg" placeholder="Result Regsiter"></textarea>
      </div>

          <h1 class="text-center text-uppercase m-4"> LOGIN <small class="text-muted"> TP</small></h1>



          <div class="form-group row">
            <label for="field-mail" class="col-sm-2 col-form-label"> E-mail</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="field-mail-log" placeholder="E-mail" >
            </div>
          </div>

          <div class="form-group row">
            <label for="field-pass" class="col-sm-2 col-form-label"> PassWord</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id="field-pass-log" placeholder="PassWord" >
            </div>
          </div>

          <div class="form-group row">
            <input type="button" style="margin:auto; margin-top: 2%; margin-bottom: 2%;
            " id="btn-login"  class="btn btn-primary" value="Login">
          </div>
           <div class="col-sm-10">
        <textarea type="text" class="form-control" name ="resultlog" id="resultlog" placeholder="Resultat Login" ></textarea>
      </div>



        </form>
        <br/>
          <br/>
            <br/>

        <table id="table-register">
          <thead>
            <th>name</th>
            <th>pass</th>
            <th>Email</th>
          </thead>
          <tbody id="tbody-register">

          </tbody>
        </table>
      </div>
    </body>
<script type="text/javascript">
  

  window.addEventListener('load', BDD);

var db = openDatabase("myDB", "1.0", "TiPS Database Example", 2 * 1024 * 1024);


function BDD(){    

    document.getElementById('btn-save').addEventListener('click', save);
    document.getElementById('btn-delet').addEventListener('click', delet);
    document.getElementById('btn-login').addEventListener('click', login);
    
    db.transaction(function(tx) {

        tx.executeSql("CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY,name TEXT,pass TEXT, email TEXT)" );

});
    
    montrer();
    
}   

function save(){
    var id = document.getElementById('field-id').value;
    var name = document.getElementById('field-name').value;
    var pass = document.getElementById('field-pass').value;
    var mail = document.getElementById('field-mail').value;

    db.transaction(function(tx) {
        if(id){
            tx.executeSql('UPDATE users SET name=?, pass=?, email=? WHERE id=?', [name,pass,mail,id],null);
            document.getElementById('resultReg').textContent = "Your account has been modified ";
        }else{
            mail =CryptoJS.AES.encrypt(mail,"TpHahage");
            pass = calcMD5(pass);
            tx.executeSql('INSERT INTO users ( name,pass,email) VALUES (?, ?, ?)', [name,pass,mail]);
            document.getElementById('resultReg').textContent = "WELCOME";

        }
    });

    montrer();
    Champs();
    inputSHOW(false);
}

function montrer(){        
    var table = document.getElementById('tbody-register');

    db.transaction(function(tx) {
        tx.executeSql('SELECT * FROM users', [], function (tx, result) {
            var rows = result.rows;
            var tr = '';
            for(var i = 0; i < rows.length; i++){
                tr += '<tr>';
                tr += '<td onClick="actualise(' + rows[i].id + ')">' + rows[i].name + '</td>';
                tr += '<td>' + rows[i].pass + '</td>';
                tr += '<td>' + rows[i].email + '</td>';
                tr += '</tr>';                   
            }
            table.innerHTML = tr; 

        }, null);
    });
}
function login(){ 
    var mail = document.getElementById('field-mail-log');
    var pass = document.getElementById('field-pass-log');       
    var _mail = mail.value;
    var _pass = calcMD5(pass.value);


    var resultat = 0;

   
    db.transaction(function(tx) {
        tx.executeSql('SELECT * FROM users', [], function (tx, result) {
            
           

            var rows = result.rows;
            var test = myFunction(rows[0].email);

            console.log(test);
           console.log(rows[0].pass);
           console.log("---------------------------------")
           console.log(_pass);
           console.log(_mail);


            for(var i = 0; i < rows.length; i++){

               if(_mail == test) {

                if(_pass == rows[i].pass) {

                    
                resultat = 1;

               }

            }

        }
    if(resultat == 1){
        document.getElementById('resultlog').textContent = "YOU ARE LOGIN ! : " +  test;
    }else{
        document.getElementById('resultlog').textContent = "ERROR LOGIN : " ;
    }



     }, null);
   
});
}



function actualise(_id){   

    var id = document.getElementById('field-id');
    var name = document.getElementById('field-name');
    var pass = document.getElementById('field-pass');
    var mail = document.getElementById('field-mail');
    
    id.value = _id;
    
    db.transaction(function(tx) {
        tx.executeSql('SELECT * FROM users WHERE id=?', [_id], function (tx, result) {
            var rows = result.rows[0];

            name.value = rows.name ;
            pass.value = rows.pass ;
            mail.value = rows.email ;
        });
    });
    inputSHOW(true);
}

function delet(){

    var id = document.getElementById('field-id').value;
    
    db.transaction(function(tx) {
        tx.executeSql("delete FROM users WHERE id=?", [id]);
    });
    
    montrer();
    Champs();
    inputSHOW(false);
}

        function hex_to_ascii(str1)
        {
          var hex  = str1.toString();
          var str = '';
          for (var n = 0; n < hex.length; n += 2) {
            str += String.fromCharCode(parseInt(hex.substr(n, 2), 16));
          }
          return str;
        }


        function myFunction(test) {
          
          let decrypted = CryptoJS.AES.decrypt(test,"TpHahage");
          decrypted = hex_to_ascii(decrypted);
          test = decrypted;
          console.log(decrypted);
          return test;
        
        };

</script>
    </html>

